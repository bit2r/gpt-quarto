# 대한민국

## Row

```{r}
#| content: valuebox
#| title: "확진자수"

confirmed <- valuebox_stat |> 
  filter(type == "confirmed") |>
  pull(사례수) 

list(
  icon = "hospital",
  color = "yellow",
  value = scales::comma(confirmed)
)
```


```{r}
#| content: valuebox
#| title: "사망자수"

death <- valuebox_stat |> 
  filter(type == "death") |>
  pull(사례수) 

list(
  icon = "moon-fill",
  color = "danger",
  value = scales::comma(death)
)
```


```{r}
#| content: valuebox
#| title: "회복자수"

recovery <- valuebox_stat |> 
  filter(type == "recovery") |>
  pull(사례수) 

list(
  icon = "heart-fill",
  color = "green",
  value = scales::comma(recovery)
)
```


## Column

### 표

```{r}
#| title: 월별 코로나 통계표

coronavirus |> 
  filter(str_detect(country, "Korea")) |> 
  mutate(yearmon = floor_date(date, "month")) |> 
  group_by(yearmon, type) |>
  summarise(사례수 = sum(cases)) |> 
  pivot_wider(names_from = type, values_from = 사례수) |> 
  ungroup() |> 
  arrange(desc(yearmon)) |> 
  gt() |> 
  cols_align(columns = yearmon, "center") |> 
  cols_label(yearmon = "년월",
             confirmed = "확진자수", 
             death = "사망자수", 
             recovery = "회복자수") |> 
  fmt_number(columns = 2:4, decimals = 0) |> 
  # gtExtras::gt_theme_538() |> 
  opt_interactive(
    use_filters = TRUE,
    use_compact_mode = TRUE,
    use_text_wrapping = FALSE
  ) |> 
  data_color(
    columns = recovery,
    palette = "Greens"
  ) |>
  data_color(
    columns = death,
    palette = "Purples"
  ) |>
  data_color(
    columns = confirmed,
    palette = "Blues"
  )   
```


### 그래프

```{r}
#| title: 코로나 그래프

coronavirus |> 
  filter(str_detect(country, "Korea")) |> 
  mutate(yearmon = floor_date(date, "month")) |> 
  group_by(yearmon, type) |>
  summarise(사례수 = sum(cases)) |> 
  ungroup() |> 
  ggplot(aes(x = yearmon, y = 사례수, color = type)) +
   geom_line() +
   geom_point() +
   theme_minimal() +
   theme(legend.position = "none") +
   scale_y_sqrt(labels = scales::comma) +
   labs(title = "대한민국 코로나19 추이",
        y = "사례수",
        x = NULL,
        color = "종류") +
    facet_wrap(~type, scales = "free_y")
```

