<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko-KR" xml:lang="ko-KR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="이광춘">

<title>챗GPT 쿼토(Quarto) – 16&nbsp; 변수 설정 문서</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./gpt_writing.html" rel="next">
<link href="./dw_book.html" rel="prev">
<link href="./images/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-229551680-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script defer="" data-domain="r2bit.com/gpt-quarto" src="https://plausible.io/js/script.js"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dw_website.html">저작물</a></li><li class="breadcrumb-item"><a href="./dw_params.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">변수 설정 문서</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">챗GPT 쿼토(Quarto)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/bit2r/gpt-quarto/" title="소스 코드" class="quarto-navigation-tool px-1" aria-label="소스 코드"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="리더 모드 전환">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">시작을 위한 준비</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup_reproducible.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">과학기술 위기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup_markdown_mess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">심각한 현재 상황</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">쿼토(Quarto)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">저작환경 설정</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">기본요소</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">문서 구성요소</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">마크다운</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">코드</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">템플릿과 테마</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theme_fonts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">글꼴</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theme_colors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">색상</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theme_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">그래프 테마</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theme_gt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">표 테마</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">저작물</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dw_website.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">웹사이트와 블로그</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dw_slideshow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PPT 슬라이드</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dw_dashboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">대쉬보드</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dw_book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">쿼토 책</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dw_params.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">변수 설정 문서</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">챗GPT</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gpt_writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">챗GPT 쿼토</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gpt_resume.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">이력서</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gpt_case_study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">국제시장과 펭귄</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">참고문헌</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#문서-프로그래밍" id="toc-문서-프로그래밍" class="nav-link active" data-scroll-target="#문서-프로그래밍"><span class="header-section-number">16.1</span> 문서 프로그래밍</a></li>
  <li><a href="#보고서-자동-생성" id="toc-보고서-자동-생성" class="nav-link" data-scroll-target="#보고서-자동-생성"><span class="header-section-number">16.2</span> 보고서 자동 생성</a></li>
  <li><a href="#작업방법" id="toc-작업방법" class="nav-link" data-scroll-target="#작업방법"><span class="header-section-number">16.3</span> 작업방법</a>
  <ul class="collapse">
  <li><a href="#기본-보고서" id="toc-기본-보고서" class="nav-link" data-scroll-target="#기본-보고서"><span class="header-section-number">16.3.1</span> 기본 보고서</a></li>
  </ul></li>
  <li><a href="#매개변수-보고서" id="toc-매개변수-보고서" class="nav-link" data-scroll-target="#매개변수-보고서"><span class="header-section-number">16.4</span> 매개변수 보고서</a></li>
  <li><a href="#보고서-자동-생성-1" id="toc-보고서-자동-생성-1" class="nav-link" data-scroll-target="#보고서-자동-생성-1"><span class="header-section-number">16.5</span> 보고서 자동 생성</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bit2r/gpt-quarto/edit/main/dw_params.qmd" class="toc-action"><i class="bi bi-github"></i>편집</a></li><li><a href="https://github.com/bit2r/gpt-quarto/issues/new" class="toc-action"><i class="bi empty"></i>이슈 보고</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dw_website.html">저작물</a></li><li class="breadcrumb-item"><a href="./dw_params.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">변수 설정 문서</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">변수 설정 문서</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>변수 설정 문서</strong>는 <code>parameterized report</code>를 저자가 번역한 것으로 R/파이썬 프로그램을 작성할 때 입력값을 달리 받는 함수를 생각하면 이해하기 쉽다. 함수는 입력값에 따라 다른 결과를 출력하는데 변수 설정 문서도 입력값을 달리하면 다른 PDF/HTML/워드 문서가 제작되는 것으로 생각하면 된다.</p>
<p>변수 설정 문서는 데이터 분석과 보고서 작성에서 매우 유용하다. 하나의 보고서 템플릿으로 다양한 데이터셋에 대해 개별 보고서를 생성할 수 있어 중복 작업을 크게 줄일 수 있고, 동일한 코드와 템플릿을 사용하기 때문에 보고서 간 일관성이 유지되고 오류의 가능성도 줄일 수 있다.</p>
<p>특히, 맞춤형 보고가 필요한 경우에 유용하다. 예를 들어, 기업에서 각 지점별 월별 매출 보고서를 생성할 때 지점별 데이터만 바꿔가며 각 지점에 맞는 맞춤형 보고서를 쉽게 제작할 수 있다. 이런 방식은 의료 데이터 분석, 학술 연구, 정부 및 공공기관 데이터 보고, 마케팅 분석 등 다양한 분야에서 활용될 수 있다.</p>
<p>변수 설정 문서는 한번 설정해두면 새로운 데이터가 들어올 때마다, 자동으로 보고서를 업데이트하거나 동일한 보고서를 HTML, PDF, 워드 등 다양한 형식으로 쉽게 변환할 수 있다는 점에서 확장성도 뛰어나다.</p>
<section id="문서-프로그래밍" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="문서-프로그래밍"><span class="header-section-number">16.1</span> 문서 프로그래밍</h2>
<p>일반적인 보고서 작성을 위한 작업흐름과 필요한 요소는 다음과 같다. 데이터 기반 보고서를 작성할 때 데이터와 데이터를 처리하는데 필요한 R/파이썬/SAS/SPSS/파이썬 스크립트, 마크다운으로 작성한 문서가 포함된다. 즉, 데이터를 데이터베이스, 웹, 파일형태로 가져오면 R 스크립트를 통해 전처리를 하고 필요한 통계량을 뽑아내고 시각적으로 히스토그램, 막대그래프, 원그래프, 시계열 추세 선 그래프 등이 포함된다. 그리고, 데이터에서 나온 다양한 통계량 및 시각적 산출물에 대한 견해와 함께 최종 보고서 작성자의 의견을 덧붙여 마무리하고 보고서 작성자, 참고문헌, 목차, 각주 등을 붙여 보고서를 완성한다.</p>
<p>GUI가 아닌 CLI 방식으로 데이터를 분석한 후에 이를 <code>.R</code>, <code>.py</code> 파일로 저장하고 나서 이를 <code>.qmd</code> 파일(코드와 문서)로 함께 작성한 뒤에 이를 기계에 던져 원하는 형태의 문서 <code>.pdf</code>, <code>.html</code>, <code>.docx</code> 파일을 뽑아내서 웹, PC 배포문서, 저작 가능한 문서 형태로 배포한다.</p>
<div id="fig-params_workflow" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-params_workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/params_workflow.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="그림&nbsp;16.1: 문학적 프로그래밍 구성요소와 작업흐름"><img src="images/params_workflow.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-params_workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;16.1: 문학적 프로그래밍 구성요소와 작업흐름
</figcaption>
</figure>
</div>
</section>
<section id="보고서-자동-생성" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="보고서-자동-생성"><span class="header-section-number">16.2</span> 보고서 자동 생성</h2>
<p>하루일과는 아침에 일어나서 밥을 먹고, 학교나 회사에 출근하고, 점심먹고, 오후에 놀거나 추가 작업을 하고, 퇴근을 하고 저녁을 먹고, 쉬고 잠을 자는 과정이 일반적인 일상이다. 이런 과정이 매일 매일 반복된다. 마찬가지로 보고서도 이런 일상적인 과정을 담아내야 한다. 즉, 일별로 생성되는 데이터를 동일한 형태의 보고서로 작성하게 된다. 이를 위해 상기 “일반적인 보고서 작성 흐름”을 복사해서 붙여넣기 신공을 발휘하기 보다는 데이터를 바꿔넣고 해당 데이터를 매개변수(parameter)로 넘겨 일별 보고서 생성을 자동화시킨다.</p>
<p>따라서, 일자 정보를 <code>.qmd</code> 파일에 전달하는 과정을 거치는 것이 필요하고, 통계보고서를 자동생성시키는 과정을 별도 스크립트로 만들어서 실행시킨다.</p>
<div id="fig-params-daily" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-params-daily-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/params_daily.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="그림&nbsp;16.2: 일별 보고서 자동생성"><img src="images/params_daily.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-params-daily-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;16.2: 일별 보고서 자동생성
</figcaption>
</figure>
</div>
</section>
<section id="작업방법" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="작업방법"><span class="header-section-number">16.3</span> 작업방법</h2>
<p>변수 설정 문서는 프로그래밍 함수의 개념을 문서 생성에 확장한 것으로 문서 제작자는 단 하나의 템플릿을 이용해 입력값을 달리하여 맞춤형 문서를 생성할 수 있다. 먼저, ‘보고서.qmd’라는 쿼토 보고서 문서를 하나 생성해야 한다. 이는 마치 R/파이썬에서 스크립트를 작성하는 것과 유사하다. 다음 단계로 R/파이썬 함수를 만드는 과정이 필요한데 YAML 헤더에 인자를 <code>params</code>으로 설정한다. 인자는 하나일 필요는 없고 여러 개일 수도 있다. <code>템플릿.qmd</code> 파일에 ’params’ 옵션을 사용해 ‘province’ 변수 값을 ’서울특별시’와 같이 지정하면, 해당 지역에 맞는 내용을 담은 문서를 생성할 수 있다. 템플릿과 데이터, 스크립트를 조합하여 최종 PDF, HTML, DOCX 형태 최종 문서를 생성할 수 있다. 이런 식으로 변수 설정 문서는 하나의 템플릿에서 시작해 다수의 맞춤형 문서를 효율적으로 생성할 수 있는 방법을 제공한다.</p>
<div id="fig-params-automation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-params-automation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/params_quarto.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="그림&nbsp;16.3: 매개변수 문서 제작과정"><img src="images/params_quarto.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-params-automation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;16.3: 매개변수 문서 제작과정
</figcaption>
</figure>
</div>
<p>변수설정 보고서 실제 사례로 제19대 대통령선거에서 시도별 특성을 반영한 개별 보고서를 PDF로 작성하는 과정을 살펴보자.</p>
<section id="기본-보고서" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="기본-보고서"><span class="header-section-number">16.3.1</span> 기본 보고서</h3>
<p><code>report.qmd</code> 보고서 파일은 PDF 파일을 제작하기 위해 YAML 헤더 <code>.qmd</code> 파일에 <code>latex-engine: xelatex</code>으로 <code>xelatex</code>을 설정하고 로컬 컴퓨터에 설치된 <code>CJKmainfont: NanumGothic</code>을 통해 <code>NanumGothic</code> 글꼴을 지정했다.</p>
<div class="sourceCode" id="cb1" data-startfrom="1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">---</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>title: <span class="st">"대통령 선거 득표 보고서"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>subtitle: <span class="st">"경기도 "</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>author:</span>
<span id="cb1-5"><a href="#cb1-5"></a>    name: 이광춘</span>
<span id="cb1-6"><a href="#cb1-6"></a>    affilates: 한국 R 사용자회</span>
<span id="cb1-7"><a href="#cb1-7"></a>date: <span class="st">"`r Sys.Date()`"</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="bu">format</span>:</span>
<span id="cb1-9"><a href="#cb1-9"></a>  pdf:</span>
<span id="cb1-10"><a href="#cb1-10"></a>    latex<span class="op">-</span>engine: xelatex   </span>
<span id="cb1-11"><a href="#cb1-11"></a>    keep<span class="op">-</span>tex: false          </span>
<span id="cb1-12"><a href="#cb1-12"></a>CJKmainfont: NanumGothic</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>report.qmd</code> 파일을 쿼토로 컴파일하게 되면 <code>report.pdf</code>이 생성된다.</p>
<div id="fig-params-pdf-report" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-params-pdf-report-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/params_pdf_report.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="그림&nbsp;16.4: 쿼토 기본 PDF 보고서"><img src="images/params_pdf_report.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-params-pdf-report-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;16.4: 쿼토 기본 PDF 보고서
</figcaption>
</figure>
</div>
</section>
</section>
<section id="매개변수-보고서" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="매개변수-보고서"><span class="header-section-number">16.4</span> 매개변수 보고서</h2>
<p><code>report_template.qmd</code> 파일은 <code>report.qmd</code> 파일을 템플릿으로 사용하여 <code>params</code> 옵션을 사용해 <code>province</code> 변수 값을 <code>서울특별시</code>로 지정해서 매개변수를 보고서에 적용했다. 주목해서 살펴볼 점은 <code>subtitle:</code> 부분에 <code>r</code> <code>params$province</code>으로 변수값 중 <code>province</code>를 지정했다는 점이다. <code>province</code> 변수 값을 <code>서울특별시</code> 대신 다른 시도로 변경하면 변경된 값이 그대로 적용된다.</p>
<div class="sourceCode" id="cb2" data-startfrom="1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">---</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>title: <span class="st">"대통령 선거 득표 보고서"</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>subtitle: <span class="st">"`r params$province`"</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>author:</span>
<span id="cb2-5"><a href="#cb2-5"></a>    name: 이광춘</span>
<span id="cb2-6"><a href="#cb2-6"></a>    affilates: 한국 R 사용자회</span>
<span id="cb2-7"><a href="#cb2-7"></a>date: <span class="st">"`r Sys.Date()`"</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="bu">format</span>:</span>
<span id="cb2-9"><a href="#cb2-9"></a>  pdf:</span>
<span id="cb2-10"><a href="#cb2-10"></a>    latex<span class="op">-</span>engine: xelatex   </span>
<span id="cb2-11"><a href="#cb2-11"></a>    keep<span class="op">-</span>tex: false          </span>
<span id="cb2-12"><a href="#cb2-12"></a>CJKmainfont: NanumGothic</span>
<span id="cb2-13"><a href="#cb2-13"></a>params:</span>
<span id="cb2-14"><a href="#cb2-14"></a>  province: <span class="st">"서울특별시"</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>한걸음 더 나아가 <code>r</code> <code>params$province</code> 변수값을 마크다운 뿐만 아니라 R 코드에도 적용한다는 점이다. <code>params$province</code>를 변수로 필요한 곳(마크다운, R/파이썬 코드)에 적용시킴으로써 유연한 보고서를 복사하여 붙여넣기 대신하여 자유자재로 생성할 수 있다.</p>
<div class="sourceCode" id="cb3" data-startfrom="25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python" style="counter-reset: source-line 24;"><span id="cb3-25"><a href="#cb3-25"></a><span class="op">---</span></span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co"># 대선 득표 데이터 {#election-dataset}</span></span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a>엑셀로 정리된 제<span class="dv">19</span><span class="er">대</span> 대통령선거 데이터 중 `r params$province` 데이터만 가져와서  시각화와 표제작을 위한 적절한 형태로 정제 작업을 거친다. </span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="보고서-자동-생성-1" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="보고서-자동-생성-1"><span class="header-section-number">16.5</span> 보고서 자동 생성</h2>
<p>시도별 PDF 보고서를 달리하여 생성하기 위해서는 데이터와 스크립트가 필요한데 본 보고서의 경우 데이터가 복잡하지 않고 단순히 시도명만 필요하기 때문에 제19대 대통령 선거 결과 데이터에서 시도명을 추출하여 벡터로 만든 후에 이를 <code>quarto</code> 패키지 <code>quarto::quarto_render</code> 함수에 전달한다. <code>for</code> 반복문을 돌리면서 시도명을 쿼토 <code>report_template.qmd</code> 보고서에 전달하여 완성된 <code>.qmd</code> 파일을 생성한 후 PDF 파일을 제작하는 과정을 전체 시도에 대해서 반복한다.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># 0. 환경설정 ---------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>library(tidyverse)</span>
<span id="cb4-3"><a href="#cb4-3"></a>library(quarto)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># 1. 시도명 ---------------------------------------</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>provinces <span class="op">&lt;-</span> c(<span class="st">"강원도"</span>, <span class="st">"경기도"</span>, <span class="st">"경상남도"</span>, <span class="st">"경상북도"</span>, <span class="st">"광주광역시"</span>, </span>
<span id="cb4-7"><a href="#cb4-7"></a>               <span class="st">"대구광역시"</span>, <span class="st">"대전광역시"</span>, <span class="st">"부산광역시"</span>, <span class="st">"서울특별시"</span>, </span>
<span id="cb4-8"><a href="#cb4-8"></a>               <span class="st">"세종특별자치시"</span>, <span class="st">"울산광역시"</span>, <span class="st">"인천광역시"</span>, <span class="st">"전라남도"</span>, </span>
<span id="cb4-9"><a href="#cb4-9"></a>               <span class="st">"전라북도"</span>, <span class="st">"제주특별자치도"</span>, <span class="st">"충청남도"</span>, <span class="st">"충청북도"</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># 2. 보고서 만들기 ---------------------------------------</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="cf">for</span>(province <span class="kw">in</span> provinces) {</span>
<span id="cb4-13"><a href="#cb4-13"></a>  quarto_render(<span class="bu">input</span> <span class="op">=</span> str_glue(<span class="st">"{here::here()}/report_template.qmd"</span>),</span>
<span id="cb4-14"><a href="#cb4-14"></a>                execute_params <span class="op">=</span> <span class="bu">list</span>(province <span class="op">=</span> province),</span>
<span id="cb4-15"><a href="#cb4-15"></a>                output_file <span class="op">=</span> str_glue(<span class="st">"report_</span><span class="sc">{province}</span><span class="st">.pdf"</span>))</span>
<span id="cb4-16"><a href="#cb4-16"></a>}</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>현재기준 <code>quarto</code> <code>quarto_render</code> 함수에 출력 디렉토리를 지정하는 기능은 별도 제공되고 있지 않아 자동으로 생성된 PDF 보고서는 작업 디렉토리 루트에 저장된다. 이것도 자동화하기 위해 <code>move</code> 기능을 추가로 와일드카드가 포함된 정규표현식을 사용하여 코드를 작성하면 된다.</p>
<div id="fig-params-provinces" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-params-provinces-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/params_provinces.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="그림&nbsp;16.5: 시도별 PDF 분석보고서 자동생성결과"><img src="images/params_provinces.jpg" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-params-provinces-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;16.5: 시도별 PDF 분석보고서 자동생성결과
</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./dw_book.html" class="pagination-link" aria-label="쿼토 책">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">쿼토 책</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./gpt_writing.html" class="pagination-link" aria-label="챗GPT 쿼토">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">챗GPT 쿼토</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>챗GPT 쿼토 책은 소프트웨어 카펜트리 Introduction to Reproducible Publications with Quarto 번역한 것이 포함되어 있습니다.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bit2r/gpt-quarto/edit/main/dw_params.qmd" class="toc-action"><i class="bi bi-github"></i>편집</a></li><li><a href="https://github.com/bit2r/gpt-quarto/issues/new" class="toc-action"><i class="bi empty"></i>이슈 보고</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>순수하게 <a href="https://quarto.org/">쿼토(Quarto)</a>로 제작되었습니다.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","closeEffect":"zoom","loop":false,"descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>